<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volunteer Management System</title>
    <link rel="stylesheet" href="../static/css/dashboard.css">

</head>

<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="header-left">
                <h1>üóÇÔ∏è Volunteer Management System</h1>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <div class="user-email" id="user-email">Loading...</div>
                    <div class="user-role" id="user-role"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <div class="nav-tabs">
        <div class="nav-tabs-container">
            <button class="nav-tab" data-tab="calendar">üìÖ Calendar</button>
            <button class="nav-tab hidden" data-tab="shifts" id="tab-shifts">üîß Manage Shifts</button>
            <button class="nav-tab hidden" data-tab="admin" id="tab-admin">üë• Admin Panel</button>
        </div>
    </div>

    <!-- Pantry Selector (hidden by default, shown for Manage Shifts/Admin) -->
    <div class="pantry-selector" id="pantry-selector" style="display: none;">
        <div class="pantry-selector-container">
            <label for="pantry-select">Select Pantry:</label>
            <select id="pantry-select">
                <option value="">Loading pantries...</option>
            </select>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Calendar Tab (All Users) -->
        <div class="tab-content active" id="content-calendar">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Available Shifts</h2>
                </div>
                <div id="message-calendar" class="message"></div>
                <div id="shifts-container" class="loading">
                    <div class="spinner"></div>
                    <p>Loading shifts...</p>
                </div>
            </div>
        </div>

        <!-- Manage Shifts Tab (Admin Only) -->
        <div class="tab-content" id="content-shifts">
            <!-- Create Shift Form -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Create New Shift</h2>
                </div>
                <div id="message-shifts" class="message"></div>
                <form id="create-shift-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="shift-name">Shift Name *</label>
                            <input type="text" id="shift-name" name="shift_name" placeholder="e.g., Food Distribution"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="shift-start">Start Time *</label>
                            <input type="datetime-local" id="shift-start" name="start_time" required>
                        </div>
                        <div class="form-group">
                            <label for="shift-end">End Time *</label>
                            <input type="datetime-local" id="shift-end" name="end_time" required>
                        </div>
                    </div>

                    <div class="card" style="background: #f7fafc; margin-bottom: 1rem;">
                        <div class="card-header" style="border-bottom: none; padding-bottom: 0;">
                            <h3 style="font-size: 1rem; color: #4a5568;">Roles/Positions for this Shift</h3>
                            <button type="button" class="btn btn-secondary" id="add-role-btn">+ Add Role</button>
                        </div>
                        <div id="roles-container">
                            <div class="role-input-group">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Role Title *</label>
                                        <input type="text" class="role-title" placeholder="e.g., Greeter" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Required Count *</label>
                                        <input type="number" class="role-count" min="1" value="1" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">‚úì Create Shift with Roles</button>
                </form>
            </div>

            <!-- List Existing Shifts -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Existing Shifts</h2>
                </div>
                <div class="table-container">
                    <table id="shifts-table">
                        <thead>
                            <tr>
                                <th>Shift Name</th>
                                <th>Date & Time</th>
                                <th>Roles</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="shifts-table-body">
                            <tr>
                                <td colspan="4" style="text-align: center; color: #718096;">No shifts created yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Admin Panel Tab (Admin Only) -->
        <div class="tab-content" id="content-admin">
            <!-- Create Pantry -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Create Pantry</h2>
                </div>
                <div id="message-pantry" class="message"></div>
                <form id="create-pantry-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="pantry-name">Pantry Name *</label>
                            <input type="text" id="pantry-name" name="name" placeholder="e.g., Downtown Food Pantry"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="pantry-address">Location Address *</label>
                            <input type="text" id="pantry-address" name="location_address"
                                placeholder="123 Main St, City" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">+ Create Pantry</button>
                </form>
            </div>

            <!-- Assign Pantry Leads -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Assign Pantry Leads</h2>
                </div>
                <div id="message-assign" class="message"></div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="assign-pantry">Select Pantry *</label>
                        <select id="assign-pantry">
                            <option value="">-- Select Pantry --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="assign-lead">Select Pantry Lead *</label>
                        <select id="assign-lead">
                            <option value="">-- Select Lead --</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button class="btn btn-success" id="assign-lead-btn">‚úì Assign Lead</button>
                    <button class="btn btn-danger" id="remove-lead-btn">‚úó Remove Lead</button>
                </div>
            </div>

            <!-- Pantries and Leads Table -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Pantries & Their Leads</h2>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Pantry Name</th>
                                <th>Location</th>
                                <th>Assigned Leads</th>
                            </tr>
                        </thead>
                        <tbody id="pantries-table-body">
                            <tr>
                                <td colspan="3" style="text-align: center; color: #718096;">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Include JavaScript Modules -->
    <script src="{{ url_for('static', filename='js/api-helpers.js') }}"></script>
    <script src="{{ url_for('static', filename='js/user-functions.js') }}"></script>
    <script src="{{ url_for('static', filename='js/admin-functions.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lead-functions.js') }}"></script>
    <script src="{{ url_for('static', filename='js/volunteer-functions.js') }}"></script>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>